---
title: "chatGPT"
subtitle: "~~노동자~~ 개발자 날"
author:
  - name: 이광춘
    url: https://www.linkedin.com/in/kwangchunlee/
    affiliation: 한국 R 사용자회
    affiliation-url: https://github.com/bit2r
title-block-banner: true
#title-block-banner: "#562457"
format:
  html:
    css: css/quarto.css
    theme: flatly
    code-fold: true
    toc: true
    toc-depth: 3
    toc-title: 목차
    number-sections: true
    highlight-style: github    
    self-contained: false
filters:
   - lightbox
lightbox: auto
link-citations: true
knitr:
  opts_chunk: 
    message: false
    warning: false
    collapse: true
    comment: "#>" 
    R.options:
      knitr.graphics.auto_pdf: true
editor_options: 
  chunk_output_type: console
bibliography: bibliography.bib
csl: apa-single-spaced.csl    
editor: 
  markdown: 
    wrap: sentence
---

# OpenAI 개발자 날

[[New models and developer products announced at DevDay](https://openai.com/blog/new-models-and-developer-products-announced-at-devday)]{.aside}


<iframe width="560" height="315" src="https://www.youtube.com/embed/U9mJuUkhUzk?si=92ZTbuZUuL8wZwUW" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen>

</iframe>

# 챗GPT-4 터보

## 최근 지식

2021년 9월 → 2023년 4월

::: panel-tabset
### GPT3-5-turbo

![2023년 11월 7일 기준](images/chatGPT4_turbo/gpt_3_5_turbo.jpg)

### GPT-4 + 빙검색

![2023년 11월 7일 기준](images/chatGPT4_turbo/gpt_4_bing.jpg)

### GPT-4

![2023년 11월 7일 기준](images/chatGPT4_turbo/gpt_4.jpg)

### GPT-4 터보

![2023년 11월 7일 기준](images/chatGPT4_turbo/gpt_4_turbo.jpg)
:::

## 맥락 크기

|   구분   |  GPT-4 Turbo  | GPT-4 32K | GPT-3.5 Turbo |
|:--------:|:-------------:|:-------------:|:-------------:|
| 문맥 창  | 128,000 토큰  |  32,000 토큰  |  8,192 토큰   |
| 페이지수 |   약 300 쪽   |   약 75 쪽    |   약 19 쪽    |
|   기준   | 427 토큰 / 쪽 | 427 토큰 / 쪽 | 427 토큰 / 쪽 |

## 비용

환율(1,300월/1달러)을 적용하여 1,000개 토큰 기준 비용을 산출하면 `GPT-4 Turbo`가 `GPT-4` 와 비교하면 입력기준 $\frac{1}{3}$ 저렴하다.

|     모형      | 입력(1K 토큰) | 출력(1K 토큰) |
|:-------------:|:--------------------:|:--------------------:|
|  GPT-4 Turbo  |   **13.0원**        |       **39.0원**    |
|     GPT-4     |       39.0원        |       78.0원        |
|   GPT-4 32k   |       78.0원        |       156.0원       |
| GPT-3.5 Turbo |        1.3원        |        2.6원        |
| Assistant API |       19.5원        |          \-          |

## 다중 모드성

"GPT-4 터보"는 **다중 모드성(Multimodality)**를 제공한다. 과거 텍스트, 이미지, 오디오 각각 다른 모드로 제공된 것이 "GPT-4 터보"에서 통합되어 제공된다.

- 텍스트(GPT-4)
- 이미지(DALL-E 3)
- 오디오(Whisper)

## GPT 플러그인

컴퓨터와 디지털 기술이 발전함에 따라 소프트웨어는 끊임없이 진화해왔다. 초기에는 기본적인 설치형 소프트웨어가 주를 이루었으며, 이는 특정 작업을 수행하기 위해 물리적 매체를 통해 컴퓨터에 직접 설치되어 사용된다. 사용자는 소프트웨어를 구매하고 소유하는 개념을 가지고 있었다. 

그 다음에는 웹 소프트웨어가 등장한다. 인터넷의 보급으로 클라우드 기반의 서비스들이 생겨나기 시작하면서, 사용자들은 언제 어디서나 접속 가능한 웹 애플리케이션을 이용하게 된다. 설치 필요 없이 브라우저를 통해 접근하는 이 모형은 편의성을 극대화했다.

이후 스마트폰의 보편화와 함께 앱 소프트웨어가 급부상한다. 앱 스토어를 통해 다운로드받아 모바일 기기에 설치하는 이 모형은 휴대성과 접근성을 강화하며 대중의 일상 속으로 깊숙이 들어간다.

마지막으로, 인공지능의 발달은 GPT와 같은 플러그인 소프트웨어의 출현을 가져온다. 이들은 기존의 플랫폼이나 소프트웨어에 부가적으로 통합되어, 사용자 경험을 개인화하고, 향상시키는 역할을 한다. 사용자는 이제 복잡한 명령어를 입력하거나 전문 지식이 없어도 고도의 기능을 이용할 수 있게 되었다.


:::{layout-nrow="1"}

![설치형 SW](images/chatGPT4_turbo/plugins_01_disk.png)

![웹 SW](images/chatGPT4_turbo/plugins_02_web.jpg.png)

![스마트폰 앱SW](images/chatGPT4_turbo/plugins_03_app.png)


![GPT 플러그인](images/chatGPT4_turbo/plugins_04_gpt.png)

:::

![](images/chatGPT4_turbo/openai_ecosystem.png)

## 저작권 보험

OpenAI는 만약 고객이 OpenAI의 서비스를 사용하다가 저작권 침해와 관련된 법적 문제에 직면했을 때, 법적 책임을 질 준비가 되어 있다고 공표했다. 이것은 저작권 침해에 대한 '보험'과도 같다. 구글이나 마이크로소프트와 같은 다른 대형 기술 회사들도 비슷한 약속을 해왔으며, 이로써 사용자는 해당 회사의 서비스를 사용함에 있어서 발생할 수 있는 저작권 문제에 대해 좀 더 안심하고 서비스를 이용할 수 있게 되었다. OpenAI의 이런 조치는 고객이 만약 저작권 침해로 인해 법적으로 고소를 당하게 되더라도, OpenAI가 나서서 문제를 해결하고, 필요한 법적 조치를 취해주겠다는 것을 의미한다.

# GPT 스토어

GPT 빌더(Builder)를 사용하면, 코딩 경험이 없어도 개인적 용도에 맞춘 맞춤형 GPT를 만들 수 있다. 예를 들어, 자신의 요리비법에 대한 지식을 가진 GPT를 만들어 빠르게 필요한 재료를 물어보고 음식을 제작할 수 있고, 개발자나 기업은 자체 독점 코드에 대해 훈련된 GPT를 만들어 다른 개발자들이 이를 바탕으로 앱개발을 신속히 할 수 있다.

GPT 스토어(Store)는 GPT 빌더로 제작된 GPT들이 배포되고 수익화될 플랫폼이 될 것이다. 스마트폰이 처음 나왔을 때 앱스토어가 했던 역할을 GPT 스토어가 담당하게 된다. GPT 빌더로 제작된 검증된 GPTs는 스토어에 등록되면 GPT 스토어에서 검색 가능해지고 앱스토어처럼 오늘의 앱 순위표 상단에 오를 수 있다. 생산성, 교육, 게임과 같은 범주를 확장해 나갈 것이다. 스마트폰 앱스토어에서 수익을 창출하듯이 GPT 스토어에서 수익을 창출해나가게 된다. [^gpt-store]

:::{layout-nrow="1"}

![OpenAI GPT 빌더](images/chatGPT4_turbo/gpt_builder.jpg)

![OpenAI GPT 스토어](images/chatGPT4_turbo/GPT_Store.jpg)

:::

[^gpt-store]: [App Store for AI: OpenAI’s GPT Store lets you build (and monetize) your own GPT](https://techcrunch.com/2023/11/06/app-store-for-ai-build-your-own-gpt-and-sell-it-on-openais-gpt-store/)


# 개발자 API

## 날씨 API

[OpenWeather](https://openweathermap.org/) API를 가져와서 현재 날씨를 가져온다.
`location`에 서울(seoul)을 넣으면, 서울의 현재 날씨를 가져온다.

```{python}
#| eval: false
import requests 
from dotenv import load_dotenv
import os

load_dotenv()  # This loads the environment variables from .env

# Now you can use these variables using os.environ
WEATHER_API_KEY = os.getenv('WEATHER_API_KEY')

# 현재 날씨를 가져오는 함수를 정의한다.
def get_current_weather(location, unit='celsius'):
    # 여기에 실제 날씨 API로 요청을 보내는 코드를 작성한다.
    # 예를 들어, OpenWeatherMap API를 사용할 수 있다. (API 키가 필요하다)
    # API_ENDPOINT는 사용하는 날씨 API의 엔드포인트 URL이다.
    API_ENDPOINT = 'http://api.openweathermap.org/data/2.5/weather'
    API_KEY = WEATHER_API_KEY  # 실제 날씨 API 키

    params = {
        'q': location,
        'appid': API_KEY,
        'units': 'metric' if unit == 'celsius' else 'imperial'
    }
    response = requests.get(API_ENDPOINT, params=params)
    weather_data = response.json()
    
    # 가정: weather_data에는 날씨 정보가 JSON 형태로 들어 있다.
    return weather_data

get_current_weather("seoul")
```

```bash
{'coord': {'lon': 126.9778, 'lat': 37.5683}, 'weather': [{'id': 800, 'main': 'Clear', 'description': 'clear sky', 'icon': '01n'}], 'base': 'stations', 'main': {'temp': 6.51, 'feels_like': 6.51, 'temp_min': 5.66, 'temp_max': 7.69, 'pressure': 1022, 'humidity': 81}, 'visibility': 10000, 'wind': {'speed': 0.51, 'deg': 150}, 'clouds': {'all': 0}, 'dt': 1699449426, 'sys': {'type': 1, 'id': 8105, 'country': 'KR', 'sunrise': 1699394614, 'sunset': 1699432081}, 'timezone': 32400, 'id': 1835848, 'name': 'Seoul', 'cod': 200}
```


## 챗GPT 날씨

챗GPT를 사용하여 서울 날씨를 물어보면 다음과 같이 대답한다.
현재 서울의 날씨를 직접 확인할 수는 없다.

```{python}
#| eval: false

import os
import openai

# OpenAI API를 사용할 준비를 한다.
OPENAI_API_KEY = os.getenv('OPEN_API_KEY')
openai.api_key = OPENAI_API_KEY

# 대화형 챗봇 모형을 이용하여 서울 날씨에 대한 대화를 시작한다.
response = openai.ChatCompletion.create(
    model="gpt-3.5-turbo",
    messages=[
        {"role": "user", 
        "content": "서울 날씨는 어떠하냐?"}
    ]
)

# 응답 결과를 출력한다.
print(response['choices'][0]['message']['content'])
```

```bash
저는 인공지능이므로 실시간으로 날씨 정보를 제공할 수 없습니다. 하지만 서울의 날씨 정보는 기상청 등의 날씨 사이트나 기상앱에서 확인하실 수 있습니다. 또는 "서울 날씨"라고 검색하시면 해당 정보가 나올 것입니다.
```


## Function calling

함수 호출(function calling)을 활용한 사례를 살펴보자. [^function-calling]

[^function-calling]: [OpenAI Function Calling Tutorial](https://www.datacamp.com/tutorial/open-ai-function-calling-tutorial)

### 한번 진행

```{python}
#| eval: false
import json
from datetime import date

student_1_description = "David Nguyen is a sophomore majoring in computer science at Stanford University. He is Asian American and has a 3.8 GPA. David is known for his programming skills and is an active member of the university's Robotics Club. He hopes to pursue a career in artificial intelligence after graduating."

student_2_description="Ravi Patel is a sophomore majoring in computer science at the University of Michigan. He is South Asian Indian American and has a 3.7 GPA. Ravi is an active member of the university's Chess Club and the South Asian Student Association. He hopes to pursue a career in software engineering after graduating."

# A simple prompt to extract information from "student_description" in a JSON format.
prompt1 = f'''
Please extract the following information from the given text and return it as a JSON object:

name
major
school
grades
club

This is the body of text to extract the information from:
{student_1_description}
'''

import openai

# Generating response back from gpt-3.5-turbo
openai_response = openai.ChatCompletion.create(
    model = 'gpt-3.5-turbo',
    messages = [{'role': 'user', 'content': prompt1}]
)

# Loading the response as a JSON object
json_response = json.loads(openai_response['choices'][0]['message']['content'])
json_response
```

```bash
{'name': 'David Nguyen', 'major': 'computer science', 'school': 'Stanford University', 'grades': '3.8 GPA', 'club': 'Robotics Club'}
```


### 반복 

```{python}
#| eval: false

student_custom_functions = [
    {
        'name': 'extract_student_info',
        'description': 'Get the student information from the body of the input text',
        'parameters': {
            'type': 'object',
            'properties': {
                'name': {
                    'type': 'string',
                    'description': 'Name of the person'
                },
                'major': {
                    'type': 'string',
                    'description': 'Major subject.'
                },
                'school': {
                    'type': 'string',
                    'description': 'The university name.'
                },
                'grades': {
                    'type': 'integer',
                    'description': 'GPA of the student.'
                },
                'club': {
                    'type': 'string',
                    'description': 'School club for extracurricular activities. '
                }
                
            }
        }
    }
]

student_description = [student_1_description,student_2_description]
for sample in student_description:
    response = openai.ChatCompletion.create(
        model = 'gpt-3.5-turbo',
        messages = [{'role': 'user', 'content': sample}],
        functions = student_custom_functions,
        function_call = 'auto'
    )

    # Loading the response as a JSON object
    json_response = json.loads(response['choices'][0]['message']['function_call']['arguments'])
    print(json_response)

```

```bash
{'name': 'David Nguyen', 'major': 'computer science', 'school': 'Stanford University', 'grades': 3.8, 'club': 'Robotics Club'}
{'name': 'Ravi Patel', 'major': 'computer science', 'school': 'University of Michigan', 'grades': 3.7, 'club': 'Chess Club'}
```

### 여러 작업

```{python}
#| eval: false

custom_functions = [
    {
        'name': 'extract_student_info',
        'description': 'Get the student information from the body of the input text',
        'parameters': {
            'type': 'object',
            'properties': {
                'name': {
                    'type': 'string',
                    'description': 'Name of the person'
                },
                'major': {
                    'type': 'string',
                    'description': 'Major subject.'
                },
                'school': {
                    'type': 'string',
                    'description': 'The university name.'
                },
                'grades': {
                    'type': 'integer',
                    'description': 'GPA of the student.'
                },
                'club': {
                    'type': 'string',
                    'description': 'School club for extracurricular activities. '
                }
                
            }
        }
    },
    {
        'name': 'extract_school_info',
        'description': 'Get the school information from the body of the input text',
        'parameters': {
            'type': 'object',
            'properties': {
                'name': {
                    'type': 'string',
                    'description': 'Name of the school.'
                },
                'ranking': {
                    'type': 'integer',
                    'description': 'QS world ranking of the school.'
                },
                'country': {
                    'type': 'string',
                    'description': 'Country of the school.'
                },
                'no_of_students': {
                    'type': 'integer',
                    'description': 'Number of students enrolled in the school.'
                }
            }
        }
    }
]

school_1_description = "Stanford University is a private research university located in Stanford, California, United States. It was founded in 1885 by Leland Stanford and his wife, Jane Stanford, in memory of their only child, Leland Stanford Jr. The university is ranked #5 in the world by QS World University Rankings. It has over 17,000 students, including about 7,600 undergraduates and 9,500 graduates23. "

description = [student_1_description, school_1_description]
for i in description:
    response = openai.ChatCompletion.create(
        model = 'gpt-3.5-turbo',
        messages = [{'role': 'user', 'content': i}],
        functions = custom_functions,
        function_call = 'auto'
    )

    # Loading the response as a JSON object
    json_response = json.loads(response['choices'][0]['message']['function_call']['arguments'])
    print(json_response)
    
```

```bash
{'name': 'David Nguyen', 'major': 'computer science', 'school': 'Stanford University', 'grades': 3.8, 'club': 'Robotics Club'}
{'name': 'Stanford University', 'ranking': 5, 'country': 'United States', 'no_of_students': 17000}
```
